{"version":3,"file":"nav-menu-setting.min.js","sources":["../src/nav-menu-setting.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * AMD module\n *\n * @copyright  2024 https://santoshmagar.com.np/\n * @author     santoshtmp7 https://github.com/santoshtmp/moodle-local_easycustmenu\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n *\n */\nimport $ from 'jquery';\nimport Ajax from 'core/ajax';\nimport Templates from 'core/templates';\nimport menu_drag from 'local_easycustmenu/easy-menu-drag';\n\n/**\n *\n * @param {*} menu_item_num\n * @param {*} itemdepth\n * @param {*} menu_type\n * @param {*} callback\n */\nfunction ajax_get_menu_item_context(menu_item_num, itemdepth, menu_type, callback) {\n\n    let request = {\n        methodname: 'get_menu_item_context',\n        args: {\n            menu_item_num: parseInt(menu_item_num),\n            itemdepth: parseInt(itemdepth),\n            menu_type: menu_type,\n        }\n    };\n\n    let ajax = Ajax.call([request])[0];\n    ajax.done(function (response) {\n        if (!response.status) {\n            window.console.log('something is wrong...');\n        }\n        if (callback) {\n            callback(response);\n        }\n    });\n    ajax.fail(function () {\n        window.console.log('request failed.');\n    });\n    // ajax.always(function (response) {\n    //     window.console.log(response);\n    // });\n}\n\n\nexport const init = (menu_type = 'navmenu') => {\n    //\n    menu_drag.easy_menu_drag(menu_type);\n    /**\n     * Add menu\n     */\n    $('.btn-add-menu').on('click', function (e) {\n        e.preventDefault();\n        var menu_id = $('.menu .menu-item-wrapper:last-child ').attr('id');\n        if (menu_id) {\n            menu_id = parseInt(menu_id.split('-')[1]) + 1;\n        } else {\n            menu_id = 1;\n        }\n        ajax_get_menu_item_context(menu_id, 1, menu_type, function (response) {\n            if (response.status) {\n                Templates.render(response.template_name, response.template_context)\n                    .then(function (html) {\n                        $('.menu-wrapper .menu').append(html);\n                        menu_drag.easy_menu_drag(menu_type);\n                    });\n            }\n        });\n\n\n    });\n\n    /**\n     * Remove menu\n     */\n    $(document).on('click', '.btn-remove', function (e) {\n        e.stopPropagation();\n        e.preventDefault();\n        let menu_id = $(this).attr(\"data-id\");\n        $('#' + menu_id).remove();\n    });\n\n\n    // hide - show condition field\n    $(document).on('click', '.btn-add-condition', function (e) {\n        e.stopPropagation();\n        e.preventDefault();\n        let menu_id = $(this).attr(\"data-id\");\n        if ($(this).hasClass('active')) {\n            $(this).removeClass('active');\n        } else {\n            $(this).addClass('active');\n        }\n        $('#' + menu_id + '  .condition-fields').toggle();\n    });\n\n\n    /**\n     * Change input checkbox target_blank value\n     */\n    $(document).on('change', '.target_blank_no,.target_blank_yes', function () {\n        let menu_id = $(this).parent().attr(\"data-id\");\n        if ($(this).val() == \"0\") {\n            document.getElementById('target_yes_' + menu_id).checked = false;\n        }\n        if ($(this).val() == \"1\") {\n            document.getElementById('target_no_' + menu_id).checked = false;\n        }\n    });\n\n};"],"names":["ajax_get_menu_item_context","menu_item_num","itemdepth","menu_type","callback","request","methodname","args","parseInt","ajax","Ajax","call","done","response","status","window","console","log","fail","easy_menu_drag","on","e","preventDefault","menu_id","attr","split","render","template_name","template_context","then","html","append","document","stopPropagation","this","remove","hasClass","removeClass","addClass","toggle","parent","val","getElementById","checked"],"mappings":";;;;;;;;cAmCSA,2BAA2BC,cAAeC,UAAWC,UAAWC,cAEjEC,QAAU,CACVC,WAAY,wBACZC,KAAM,CACFN,cAAeO,SAASP,eACxBC,UAAWM,SAASN,WACpBC,UAAWA,YAIfM,KAAOC,cAAKC,KAAK,CAACN,UAAU,GAChCI,KAAKG,MAAK,SAAUC,UACXA,SAASC,QACVC,OAAOC,QAAQC,IAAI,yBAEnBb,UACAA,SAASS,aAGjBJ,KAAKS,MAAK,WACNH,OAAOC,QAAQC,IAAI,+RAQP,eAACd,iEAAY,gCAEnBgB,eAAehB,+BAIvB,iBAAiBiB,GAAG,SAAS,SAAUC,GACrCA,EAAEC,qBACEC,SAAU,mBAAE,wCAAwCC,KAAK,MAM7DxB,2BAJIuB,QADAA,QACUf,SAASe,QAAQE,MAAM,KAAK,IAAM,EAElC,EAEsB,EAAGtB,WAAW,SAAUU,UACpDA,SAASC,2BACCY,OAAOb,SAASc,cAAed,SAASe,kBAC7CC,MAAK,SAAUC,0BACV,uBAAuBC,OAAOD,4BACtBX,eAAehB,wCAW3C6B,UAAUZ,GAAG,QAAS,eAAe,SAAUC,GAC7CA,EAAEY,kBACFZ,EAAEC,qBACEC,SAAU,mBAAEW,MAAMV,KAAK,+BACzB,IAAMD,SAASY,gCAKnBH,UAAUZ,GAAG,QAAS,sBAAsB,SAAUC,GACpDA,EAAEY,kBACFZ,EAAEC,qBACEC,SAAU,mBAAEW,MAAMV,KAAK,YACvB,mBAAEU,MAAME,SAAS,8BACfF,MAAMG,YAAY,8BAElBH,MAAMI,SAAS,8BAEnB,IAAMf,QAAU,uBAAuBgB,gCAO3CP,UAAUZ,GAAG,SAAU,sCAAsC,eACvDG,SAAU,mBAAEW,MAAMM,SAAShB,KAAK,WACf,MAAjB,mBAAEU,MAAMO,QACRT,SAASU,eAAe,cAAgBnB,SAASoB,SAAU,GAE1C,MAAjB,mBAAET,MAAMO,QACRT,SAASU,eAAe,aAAenB,SAASoB,SAAU"}