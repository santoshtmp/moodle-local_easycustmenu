{"version":3,"file":"nav-menu-setting.min.js","sources":["../src/nav-menu-setting.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * AMD module\n *\n * @copyright  2024 https://santoshmagar.com.np/\n * @author     santoshtmp7\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n *\n */\nimport $ from 'jquery';\n\n\nexport const init = (menu_item) => {\n    /**\n     * 1. check and set sub-menu and sub-menu-child css class for each menu item.\n     * 2. change move arrow title\n     */\n\n    let menu_define = document.querySelectorAll('.menu .menu-item-wrapper');\n    menu_define.forEach((element) => {\n        let element_id = element.getAttribute('id');\n        let sub_menu = document.querySelectorAll('.menu #' + element_id + ' .sub-menu-item-wrapper > .menu-item-child');\n        sub_menu.forEach((child) => {\n            child.classList.add(\"sub-menu\");\n            let child_id = child.getAttribute('id');\n            if (document.querySelector('.menu #' + child_id + ' > .menu-item .btn-add-sub-menu')) {\n                (document.querySelector('.menu #' + child_id + ' > .menu-item .btn-add-sub-menu')).setAttribute('title', 'Add sub menu child ');\n            }\n            (document.querySelector('.menu #' + child_id + ' > .menu-item .btn-up-arrow')).setAttribute('title', 'Move sub menu up ');\n            (document.querySelector('.menu #' + child_id + ' > .menu-item .btn-down-arrow')).setAttribute('title', 'Move sub menu down ');\n            let child_sub_menu = document.querySelectorAll('.menu #' + child_id + ' .sub-menu-item-child-wrapper > .menu-item-child');\n            child_sub_menu.forEach((e) => {\n                e.classList.add(\"sub-menu-child\");\n                let child_id = e.getAttribute('id');\n                (document.querySelector('.menu #' + child_id + ' > .menu-item .btn-up-arrow')).setAttribute('title', 'Move sub menu child up ');\n                (document.querySelector('.menu #' + child_id + ' > .menu-item .btn-down-arrow')).setAttribute('title', 'Move sub menu child down ');\n            });\n        });\n    });\n\n\n    /**\n     * Add menu\n     */\n    $('.btn-add-menu').on('click', function (e) {\n        e.preventDefault();\n        let total_menu = $('.menu .menu-item-wrapper ').length + 1;\n        menu_item = menu_item.replaceAll('null-id', 'menu-' + total_menu);\n        menu_item = menu_item.replaceAll('null-depth', '1');\n        $('.menu-wrapper .menu').append(menu_item);\n    });\n\n    /**\n     * Add sub-menu oe sub-menu-child\n     */\n    $(document).on('click', '.btn-add-sub-menu', function (e) {\n        e.preventDefault();\n        let sort_id = $(this).attr(\"data-id\");\n        let depth = parseInt($('#' + sort_id).attr('itemdepth')) + 1;\n        var class_name = 'menu-item-child';\n        var add_menu_location_class = '';\n        var item_child_count = 0;\n        if (depth === 2) {\n            class_name = class_name + ' sub-menu';\n            add_menu_location_class = ' .sub-menu-item-wrapper';\n            item_child_count = $('#' + sort_id + add_menu_location_class + ' > .menu-item-child ').length + 1;\n            menu_item = menu_item.replaceAll('sub-menu-item-wrapper', 'sub-menu-item-child-wrapper');\n            menu_item = menu_item.replaceAll('Add sub menu', 'Add sub menu child');\n            menu_item = menu_item.replaceAll('Move menu down', 'Move sub menu down');\n            menu_item = menu_item.replaceAll('Move menu upward', 'Move sub menu upward');\n        }\n        if (depth === 3) {\n            class_name = class_name + ' sub-menu-child';\n            add_menu_location_class = ' .sub-menu-item-child-wrapper';\n            item_child_count = $('#' + sort_id + add_menu_location_class + ' > .menu-item-child ').length + 1;\n            menu_item = menu_item.replaceAll('sub-menu-item-wrapper', 'no-child-item');\n            menu_item = menu_item.replaceAll('Move menu down', 'Move sub menu child down');\n            menu_item = menu_item.replaceAll('Move menu upward', 'Move sub menu child upward');\n        }\n        menu_item = menu_item.replaceAll('null-id', sort_id + '-' + item_child_count);\n        menu_item = menu_item.replaceAll('null-depth', depth);\n        menu_item = menu_item.replaceAll('menu-item-wrapper', class_name);\n        if (add_menu_location_class) {\n            $('#' + sort_id + add_menu_location_class).append(menu_item);\n        }\n\n    });\n\n    /**\n     * Remove menu\n     */\n    $(document).on('click', '.btn-remove', function (e) {\n        e.stopPropagation();\n        e.preventDefault();\n        let sort_id = $(this).attr(\"data-id\");\n        $('#' + sort_id).remove();\n    });\n\n\n    // hide - show condition field\n    $(document).on('click', '.btn-add-condition', function (e) {\n        e.stopPropagation();\n        e.preventDefault();\n        let sort_id = $(this).attr(\"data-id\");\n        if ($(this).hasClass('active')) {\n            $(this).removeClass('active');\n        } else {\n            $(this).addClass('active');\n        }\n        $('#' + sort_id + ' > .menu-item  .condition-fields').toggle();\n    });\n\n\n    /**\n     * Change input checkbox target_blank value\n     */\n    $(document).on('change', '.target_blank_no,.target_blank_yes', function () {\n        let sort_id = $(this).parent().attr(\"data-id\");\n        if ($(this).val() == \"0\") {\n            document.getElementById('target_yes_' + sort_id).checked = false;\n        }\n        if ($(this).val() == \"1\") {\n            document.getElementById('target_no_' + sort_id).checked = false;\n        }\n    });\n\n    /**\n     * Moove up and down menu item\n     */\n    $(document).on('click', '.btn-down-arrow, .btn-up-arrow', function (e) {\n        e.stopPropagation();\n        e.preventDefault();\n        var current_id = $(this).attr(\"data-id\");\n        var current_id_split = current_id.split('-');\n        var new_id = '';\n        if ((current_id_split.length - 1) > 0) {\n            for (let i = 0; i < current_id_split.length - 1; i++) {\n                new_id = new_id + current_id_split[i] + '-';\n            }\n        }\n        // to move down\n        if ($(this).hasClass('btn-down-arrow')) {\n            //get new section id\n            new_id = new_id + (parseInt(current_id_split[(current_id_split.length - 1)]) + 1);\n        }\n        // to move up\n        if ($(this).hasClass('btn-up-arrow')) {\n            //get new section id\n            new_id = new_id + (parseInt(current_id_split[(current_id_split.length - 1)]) - 1);\n        }\n        // get current section values\n        let current_label = $('#' + current_id + ' .input-label').val();\n        let current_link = $('#' + current_id + ' .input-link').val();\n        let current_target_blank_no = $('#' + current_id + ' .target_blank_no').prop(\"checked\");\n        let current_target_blank_yes = $('#' + current_id + ' .target_blank_yes').prop(\"checked\");\n        let current_language = $('#' + current_id + ' .input-language').val();\n        let current_user_role = $('#' + current_id + ' .user_role').val();\n        // get new section values\n        let new_label = $('#' + new_id + ' .input-label').val();\n        let new_link = $('#' + new_id + ' .input-link').val();\n        let new_target_blank_no = $('#' + new_id + ' .target_blank_no').prop(\"checked\");\n        let new_target_blank_yes = $('#' + new_id + ' .target_blank_yes').prop(\"checked\");\n        let new_language = $('#' + new_id + ' .input-language').val();\n        let new_user_role = $('#' + new_id + ' .user_role').val();\n        // set current section values into new section values place\n        $('#' + new_id + ' .input-label').val(current_label);\n        $('#' + new_id + ' .input-link').val(current_link);\n        $('#' + new_id + ' .target_blank_no').prop(\"checked\", current_target_blank_no);\n        $('#' + new_id + ' .target_blank_yes').prop(\"checked\", current_target_blank_yes);\n        $('#' + new_id + ' .input-language').val(current_language);\n        $('#' + new_id + ' .user_role').val(current_user_role);\n        // set new section values into new current values place\n        $('#' + current_id + ' .input-label').val(new_label);\n        $('#' + current_id + ' .input-link').val(new_link);\n        $('#' + current_id + ' .target_blank_no').prop(\"checked\", new_target_blank_no);\n        $('#' + current_id + ' .target_blank_yes').prop(\"checked\", new_target_blank_yes);\n        $('#' + current_id + ' .input-language').val(new_language);\n        $('#' + current_id + ' .user_role').val(new_user_role);\n    });\n};"],"names":["menu_item","document","querySelectorAll","forEach","element","element_id","getAttribute","child","classList","add","child_id","querySelector","setAttribute","e","on","preventDefault","total_menu","length","replaceAll","append","sort_id","this","attr","depth","parseInt","class_name","add_menu_location_class","item_child_count","stopPropagation","remove","hasClass","removeClass","addClass","toggle","parent","val","getElementById","checked","current_id","current_id_split","split","new_id","i","current_label","current_link","current_target_blank_no","prop","current_target_blank_yes","current_language","current_user_role","new_label","new_link","new_target_blank_no","new_target_blank_yes","new_language","new_user_role"],"mappings":"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"}