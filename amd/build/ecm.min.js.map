{"version":3,"file":"ecm.min.js","sources":["../src/ecm.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * AMD module\n *\n * @copyright  2024 https://santoshmagar.com.np/\n * @author     santoshtmp7\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n *\n */\n// import $ from 'jquery';\n\n\n/**\n *\n * @param {*} target_blank_menu\n */\nexport const target_blank_menu = (target_blank_menu) => {\n    if (target_blank_menu) {\n        let target_blank_on_menu = JSON.parse(target_blank_menu);\n        Object.entries(target_blank_on_menu).forEach(([key, value]) => {\n            let label = `${key}`;\n            let link = `${value}`;\n            if (link) {\n                let menu_item = document.querySelectorAll(\"nav ul li a[href$='\" + link + \"']\");\n                menu_item.forEach(item => {\n                    if (item.textContent.trim() == label) {\n                        item.setAttribute(\"target\", \"_blank\");\n                    }\n                });\n            }\n        });\n    }\n};\n\n/**\n *\n */\nexport const admin_setting_init = () => {\n    /**\n    * adjust the setting section\n    */\n    const newDiv = document.querySelector(\".easycustmenu_setting_header\");\n    if (newDiv) {\n        let beforeDiv = \"\";\n        beforeDiv = document.getElementById(\"menu_setting_collection\");\n        if (beforeDiv) {\n            const parentDiv = beforeDiv.parentNode;\n            parentDiv.insertBefore(newDiv, beforeDiv);\n        }\n        beforeDiv = document.querySelector(\"#page-admin-setting-local_easycustmenu #adminsettings .settingsform > h2\");\n        if (beforeDiv) {\n            beforeDiv.outerHTML = newDiv.outerHTML;\n        }\n        let easycustmenu_setting_header_top = document.querySelector(\".easycustmenu_setting_header_top\");\n        if (easycustmenu_setting_header_top) {\n            easycustmenu_setting_header_top.remove();\n        }\n    }\n\n\n    /**\n   *\n   * @param {*} link\n   * @param {*} label\n   * @param {*} css_class\n   * @returns\n   */\n    function get_ecm_btn(link, label, css_class = '') {\n        let btn = '<a href=\"' + link + '\" class=\"btn btn-secondary btn-manage-ecm ' + css_class + ' \" style=\"margin:8px;\">' + label + '</a>';\n        btn = new DOMParser().parseFromString(btn, 'text/html');\n        return btn.querySelector('a.btn-manage-ecm');\n\n    }\n\n    /**\n    * core custommenuitems\n    */\n    let btn_ecm_custommenuitems = get_ecm_btn(\"/local/easycustmenu/pages/navmenu.php\", \"Manage Custom Menu Through Easy Custom Menu\");\n    var show_menu_label = 'Show Default \"Custom menu items\" ';\n    var hide_menu_label = 'Hide Default \"Custom menu items\" ';\n    let btn_hide_show_custommenuitems = get_ecm_btn('#', show_menu_label, 'show_hide_custommenuitems show_menu');\n    if (document.querySelector(\"#admin-custommenuitems > .form-setting \")) {\n        document.querySelector(\"#admin-custommenuitems > .form-setting \").prepend(btn_ecm_custommenuitems);\n        document.querySelector(\"#admin-custommenuitems > .form-setting \").prepend(btn_hide_show_custommenuitems);\n        document.querySelector(\"#admin-custommenuitems > .form-setting .form-textarea\").style.display = \"none\";\n        document.querySelector(\"#admin-custommenuitems > .form-setting .form-defaultinfo \").style.display = \"none\";\n        document.querySelector(\"#admin-custommenuitems > .form-setting .form-description \").style.display = \"none\";\n\n        var element_show_hide = document.querySelector(\"#admin-custommenuitems > .form-setting a.show_hide_custommenuitems\");\n        element_show_hide.addEventListener(\"click\", function (e) {\n            e.stopPropagation();\n            e.preventDefault();\n            if (element_show_hide.classList.contains(\"show_menu\")) {\n                element_show_hide.classList.remove(\"show_menu\");\n                element_show_hide.classList.add(\"hide_menu\");\n                element_show_hide.textContent = hide_menu_label;\n                document.querySelector(\"#admin-custommenuitems > .form-setting .form-textarea\").style.display = \"block\";\n                document.querySelector(\"#admin-custommenuitems > .form-setting .form-defaultinfo \").style.display = \"block\";\n                document.querySelector(\"#admin-custommenuitems > .form-setting .form-description \").style.display = \"block\";\n            } else {\n                element_show_hide.classList.remove(\"hide_menu\");\n                element_show_hide.classList.add(\"show_menu\");\n                element_show_hide.textContent = show_menu_label;\n                document.querySelector(\"#admin-custommenuitems > .form-setting .form-textarea\").style.display = \"none\";\n                document.querySelector(\"#admin-custommenuitems > .form-setting .form-defaultinfo \").style.display = \"none\";\n                document.querySelector(\"#admin-custommenuitems > .form-setting .form-description \").style.display = \"none\";\n            }\n        });\n    }\n\n\n    /** core customusermenuitems */\n    let btn_ecm_customusermenuitems = get_ecm_btn(\"/local/easycustmenu/pages/usermenu.php\", \"Manage User Menu Through Easy Custom Menu\");\n    var show_menu_label_2 = 'Show Default \"User menu items\" ';\n    var hide_menu_label_2 = 'Hide Default \"User menu items\" ';\n    let btn_hide_show_customusermenuitems = get_ecm_btn('#', show_menu_label_2, 'show_hide_customusermenuitems show_menu');\n\n    if (document.querySelector(\"#admin-customusermenuitems > .form-setting \")) {\n        document.querySelector(\"#admin-customusermenuitems > .form-setting \").prepend(btn_ecm_customusermenuitems);\n        document.querySelector(\"#admin-customusermenuitems > .form-setting \").prepend(btn_hide_show_customusermenuitems);\n        document.querySelector(\"#admin-customusermenuitems > .form-setting .form-textarea\").style.display = \"none\";\n        document.querySelector(\"#admin-customusermenuitems > .form-setting .form-defaultinfo \").style.display = \"none\";\n        document.querySelector(\"#admin-customusermenuitems > .form-setting .form-description \").style.display = \"none\";\n\n        var element_show_hide_2 = document.querySelector(\"#admin-customusermenuitems > .form-setting a.show_hide_customusermenuitems\");\n        element_show_hide_2.addEventListener(\"click\", function (e) {\n            e.stopPropagation();\n            e.preventDefault();\n            if (element_show_hide_2.classList.contains(\"show_menu\")) {\n                element_show_hide_2.classList.remove(\"show_menu\");\n                element_show_hide_2.classList.add(\"hide_menu\");\n                element_show_hide_2.textContent = hide_menu_label_2;\n                document.querySelector(\"#admin-customusermenuitems > .form-setting .form-textarea\").style.display = \"block\";\n                document.querySelector(\"#admin-customusermenuitems > .form-setting .form-defaultinfo \").style.display = \"block\";\n                document.querySelector(\"#admin-customusermenuitems > .form-setting .form-description \").style.display = \"block\";\n            } else {\n                element_show_hide_2.classList.remove(\"hide_menu\");\n                element_show_hide_2.classList.add(\"show_menu\");\n                element_show_hide_2.textContent = show_menu_label_2;\n                document.querySelector(\"#admin-customusermenuitems > .form-setting .form-textarea\").style.display = \"none\";\n                document.querySelector(\"#admin-customusermenuitems > .form-setting .form-defaultinfo \").style.display = \"none\";\n                document.querySelector(\"#admin-customusermenuitems > .form-setting .form-description \").style.display = \"none\";\n\n            }\n        });\n    }\n};"],"names":["target_blank_menu","target_blank_on_menu","JSON","parse","Object","entries","forEach","_ref","key","value","label","link","document","querySelectorAll","item","textContent","trim","setAttribute","newDiv","querySelector","beforeDiv","getElementById","parentNode","insertBefore","outerHTML","easycustmenu_setting_header_top","remove","get_ecm_btn","css_class","btn","DOMParser","parseFromString","btn_ecm_custommenuitems","btn_hide_show_custommenuitems","prepend","style","display","element_show_hide","addEventListener","e","stopPropagation","preventDefault","classList","contains","add","btn_ecm_customusermenuitems","btn_hide_show_customusermenuitems","element_show_hide_2"],"mappings":"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"}