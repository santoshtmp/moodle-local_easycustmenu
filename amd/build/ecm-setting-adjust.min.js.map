{"version":3,"file":"ecm-setting-adjust.min.js","sources":["../src/ecm-setting-adjust.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * AMD module\n *\n * @copyright  2024 https://santoshmagar.com.np/\n * @author     santoshtmp7\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n *\n */\n// import $ from 'jquery';\n\n/**\n *\n * @param {*} default_custommenuitems\n */\nfunction ecm_setting_adjust(default_custommenuitems) {\n    /** set default_custommenuitems */\n    if (default_custommenuitems) {\n        default_custommenuitems = default_custommenuitems.replaceAll(\"line_breake_backslash_n\", \"\\n\");\n        let id_s__custommenuitems = document.querySelector(\"#id_s__custommenuitems\");\n        if (id_s__custommenuitems) {\n            id_s__custommenuitems.value = default_custommenuitems;\n        }\n    }\n\n}\n\n/**\n *\n * @param {*} target_blank_menu\n */\nfunction menu_target_blank(target_blank_menu) {\n    if (target_blank_menu) {\n        let target_blank_on_menu = JSON.parse(target_blank_menu);\n        Object.entries(target_blank_on_menu).forEach(([key, value]) => {\n            let label = `${key}`;\n            let link = `${value}`;\n            if (link) {\n                let menu_item = document.querySelectorAll(\"nav ul li a[href$='\" + link + \"']\");\n                menu_item.forEach(item => {\n                    if (item.textContent.trim() == label) {\n                        item.setAttribute(\"target\", \"_blank\");\n                    }\n                });\n            }\n        });\n    }\n\n}\n\nexport const init = (data) => {\n    ecm_setting_adjust(data.default_custommenuitems);\n    menu_target_blank(data.target_blank_menu);\n    /**\n * adjust the setting section\n */\n    const newDiv = document.querySelector(\".easycustmenu_setting_header\");\n    if (newDiv) {\n        let beforeDiv = \"\";\n        beforeDiv = document.getElementById(\"menu_setting_collection\");\n        if (beforeDiv) {\n            const parentDiv = beforeDiv.parentNode;\n            parentDiv.insertBefore(newDiv, beforeDiv);\n        }\n        beforeDiv = document.querySelector(\"#page-admin-setting-local_easycustmenu #adminsettings .settingsform > h2\");\n        if (beforeDiv) {\n            beforeDiv.outerHTML = newDiv.outerHTML;\n        }\n    }\n\n    let easycustmenu_setting_header_top = document.querySelector(\".easycustmenu_setting_header_top\");\n    if (easycustmenu_setting_header_top) {\n        easycustmenu_setting_header_top.remove();\n    }\n\n\n    /**\n     *\n     * @param {*} link\n     * @param {*} label\n     * @param {*} css_class\n     * @returns\n     */\n    function get_ecm_btn(link, label, css_class = '') {\n        let btn = '<a href=\"' + link + '\" class=\"btn btn-secondary btn-manage-ecm ' + css_class + '\" style=\"margin:8px;\">' + label + '</a>';\n        btn = new DOMParser().parseFromString(btn, 'text/html');\n        return btn.querySelector('a.btn-manage-ecm');\n\n    }\n    /**\n     * custommenuitems\n     */\n    let btn_ecm_custommenuitems = get_ecm_btn(\"/local/easycustmenu/pages/navmenu.php\", \"Manage Custom Menu Through Easy Custom Menu\");\n    var show_menu_label = 'Show Default \"Custom menu items\" Input Area';\n    var hide_menu_label = 'Hide Default \"Custom menu items\" Input Area';\n    if (document.querySelector(\"#admin-custommenuitems > .form-setting \")) {\n        document.querySelector(\"#admin-custommenuitems > .form-setting \").prepend(btn_ecm_custommenuitems);\n        document.querySelector(\"#admin-custommenuitems > .form-setting \").prepend(get_ecm_btn('#', show_menu_label, 'show_hide_customusermenuitems show_menu'));\n        document.querySelector(\"#admin-custommenuitems > .form-setting .form-textarea\").style.display = \"none\";\n        document.querySelector(\"#admin-custommenuitems > .form-setting .form-defaultinfo \").style.display = \"none\";\n        document.querySelector(\"#admin-custommenuitems > .form-setting .form-description \").style.display = \"none\";\n\n        var element_show_hide = document.querySelector(\"#admin-custommenuitems > .form-setting a.show_hide_customusermenuitems\");\n        element_show_hide.addEventListener(\"click\", function (e) {\n            e.stopPropagation();\n            e.preventDefault();\n            if (element_show_hide.classList.contains(\"show_menu\")) {\n                element_show_hide.classList.remove(\"show_menu\");\n                element_show_hide.classList.add(\"hide_menu\");\n                element_show_hide.textContent = hide_menu_label;\n                document.querySelector(\"#admin-custommenuitems > .form-setting .form-textarea\").style.display = \"block\";\n                document.querySelector(\"#admin-custommenuitems > .form-setting .form-defaultinfo \").style.display = \"block\";\n                document.querySelector(\"#admin-custommenuitems > .form-setting .form-description \").style.display = \"block\";\n            } else {\n                element_show_hide.classList.remove(\"hide_menu\");\n                element_show_hide.classList.add(\"show_menu\");\n                element_show_hide.textContent = show_menu_label;\n                document.querySelector(\"#admin-custommenuitems > .form-setting .form-textarea\").style.display = \"none\";\n                document.querySelector(\"#admin-custommenuitems > .form-setting .form-defaultinfo \").style.display = \"none\";\n                document.querySelector(\"#admin-custommenuitems > .form-setting .form-description \").style.display = \"none\";\n\n            }\n            return \"\";\n        });\n    }\n\n\n    /**customusermenuitems */\n    let btn_ecm_customusermenuitems = get_ecm_btn(\"/local/easycustmenu/pages/usermenu.php\", \"Manage User Menu Through Easy Custom Menu\");\n    if (document.querySelector(\"#admin-customusermenuitems > .form-setting\")) {\n        document.querySelector(\"#admin-customusermenuitems > .form-setting\").prepend(btn_ecm_customusermenuitems);\n    }\n};"],"names":["data","default_custommenuitems","replaceAll","id_s__custommenuitems","document","querySelector","value","ecm_setting_adjust","target_blank_menu","target_blank_on_menu","JSON","parse","Object","entries","forEach","_ref","key","label","link","querySelectorAll","item","textContent","trim","setAttribute","menu_target_blank","newDiv","beforeDiv","getElementById","parentNode","insertBefore","outerHTML","easycustmenu_setting_header_top","get_ecm_btn","css_class","btn","DOMParser","parseFromString","remove","btn_ecm_custommenuitems","prepend","style","display","element_show_hide","addEventListener","e","stopPropagation","preventDefault","classList","contains","add","btn_ecm_customusermenuitems"],"mappings":"0KAgEqBA;;;;;;;;;SAnCOC,4BAEpBA,wBAAyB,CACzBA,wBAA0BA,wBAAwBC,WAAW,0BAA2B,UACpFC,sBAAwBC,SAASC,cAAc,0BAC/CF,wBACAA,sBAAsBG,MAAQL,0BA8BtCM,CAAmBP,KAAKC,kCApBDO,sBACnBA,kBAAmB,KACfC,qBAAuBC,KAAKC,MAAMH,mBACtCI,OAAOC,QAAQJ,sBAAsBK,SAAQC,WAAEC,IAAKV,YAC5CW,gBAAWD,KACXE,eAAUZ,OACVY,MACgBd,SAASe,iBAAiB,sBAAwBD,KAAO,MAC/DJ,SAAQM,OACVA,KAAKC,YAAYC,QAAUL,OAC3BG,KAAKG,aAAa,SAAU,iBAWhDC,CAAkBxB,KAAKQ,yBAIjBiB,OAASrB,SAASC,cAAc,mCAClCoB,OAAQ,KACJC,UAAY,MAChBA,UAAYtB,SAASuB,eAAe,2BAChCD,UAAW,CACOA,UAAUE,WAClBC,aAAaJ,OAAQC,WAEnCA,UAAYtB,SAASC,cAAc,4EAC/BqB,YACAA,UAAUI,UAAYL,OAAOK,eAIjCC,gCAAkC3B,SAASC,cAAc,6CAapD2B,YAAYd,KAAMD,WAAOgB,iEAAY,GACtCC,IAAM,YAAchB,KAAO,6CAA+Ce,UAAY,yBAA2BhB,MAAQ,cAC7HiB,KAAM,IAAIC,WAAYC,gBAAgBF,IAAK,aACpCA,IAAI7B,cAAc,oBAfzB0B,iCACAA,gCAAgCM,aAoBhCC,wBAA0BN,YAAY,wCAAyC,kDAG/E5B,SAASC,cAAc,2CAA4C,CACnED,SAASC,cAAc,2CAA2CkC,QAAQD,yBAC1ElC,SAASC,cAAc,2CAA2CkC,QAAQP,YAAY,IAJpE,8CAI0F,4CAC5G5B,SAASC,cAAc,yDAAyDmC,MAAMC,QAAU,OAChGrC,SAASC,cAAc,6DAA6DmC,MAAMC,QAAU,OACpGrC,SAASC,cAAc,6DAA6DmC,MAAMC,QAAU,WAEhGC,kBAAoBtC,SAASC,cAAc,0EAC/CqC,kBAAkBC,iBAAiB,SAAS,SAAUC,UAClDA,EAAEC,kBACFD,EAAEE,iBACEJ,kBAAkBK,UAAUC,SAAS,cACrCN,kBAAkBK,UAAUV,OAAO,aACnCK,kBAAkBK,UAAUE,IAAI,aAChCP,kBAAkBrB,YAfR,8CAgBVjB,SAASC,cAAc,yDAAyDmC,MAAMC,QAAU,QAChGrC,SAASC,cAAc,6DAA6DmC,MAAMC,QAAU,QACpGrC,SAASC,cAAc,6DAA6DmC,MAAMC,QAAU,UAEpGC,kBAAkBK,UAAUV,OAAO,aACnCK,kBAAkBK,UAAUE,IAAI,aAChCP,kBAAkBrB,YAvBR,8CAwBVjB,SAASC,cAAc,yDAAyDmC,MAAMC,QAAU,OAChGrC,SAASC,cAAc,6DAA6DmC,MAAMC,QAAU,OACpGrC,SAASC,cAAc,6DAA6DmC,MAAMC,QAAU,QAGjG,UAMXS,4BAA8BlB,YAAY,yCAA0C,6CACpF5B,SAASC,cAAc,+CACvBD,SAASC,cAAc,8CAA8CkC,QAAQW"}